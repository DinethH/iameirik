<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/polymer/lib/elements/dom-repeat.html"><link rel="import" href="../bower_components/polymer/lib/utils/debounce.html"><link rel="import" href="../bower_components/polymer/lib/utils/render-status.html"><link rel="import" href="../bower_components/byutv-jsonp/byutv-jsonp.html"><link rel="import" href="../bower_components/iron-icon/iron-icon.html"><link rel="import" href="../bower_components/iron-icons/iron-icons.html"><link rel="import" href="../bower_components/paper-button/paper-button.html"><link rel="import" href="../bower_components/iron-resizable-behavior/iron-resizable-behavior.html"><link rel="import" href="shared-styles.html"><link rel="import" href="lazy-image.html"></head><body><dom-module id="instagram-feed"><template><style include="shared-styles"></style><style>:host{display:block;width:100%;}.center{text-align:center;display:flex;justify-content:center;flex-direction:column;align-items:center;}a{text-decoration:none;}@media (min-width: 401px){.item{display:block;padding:8px;}}@media (max-width: 400px){.item{display:block;padding:1px;}}lazy-image{width:100%;height:100%;}.grid{width:100%;display:flex;flex-wrap:wrap;justify-content:center;}[hidden]{display:none;}</style><byutv-jsonp id="jsonp" url="https://api.instagram.com/v1/users/self/media/recent/" on-response="_onResponse" debounce-duration="300"></byutv-jsonp><div class="center"><slot></slot></div><div class="grid"><template is="dom-repeat" items="{{_items}}"><a class="item" target="_blank" href="[[item.link]]"><lazy-image src="[[item.images.standard_resolution.url]]"></lazy-image></a></template></div><div class="center" hidden$="{{_shouldShowFollowButton(url)}}"><br><a href="[[url]]"><paper-button>Follow on Instagram &nbsp;<iron-icon icon="arrow-forward"></iron-icon></paper-button></a></div></template><script>class InstagramFeed extends Polymer.mixinBehaviors([Polymer.IronResizableBehavior],Polymer.Element){static get is(){return'instagram-feed'}static get properties(){return{accessToken:{type:String,value:''},url:{type:String,value:null},_items:{type:Array,value:[]},_data:{type:Array,value:[]}}}static get observers(){return['_setAccessToken(accessToken)']}connectedCallback(){super.connectedCallback(),this.addEventListener('iron-resize',()=>this._onIronResize())}_setAccessToken(a){if(a){this.$.jsonp.params={access_token:a},this.$.jsonp.generateRequest()}}_onResponse(a){this._data=a.detail.data,this._populateItems(this._data),this._setDimensions()}_onIronResize(){this._debouncer=Polymer.Debouncer.debounce(this._debouncer,Polymer.Async.timeOut.after(100),()=>{this._populateItems(this._data),this._setDimensions()})}_populateItems(a){let b;b=767<this._getHostWidth()?8:9,this._items=[];for(let c=0;c<b;c++)this.push('_items',a[c])}_getHostWidth(){return parseFloat(getComputedStyle(this).getPropertyValue('width'))}_setDimensions(){Polymer.RenderStatus.afterNextRender(this,()=>{const a=767<this._getHostWidth()?4:3,b=767<this._getHostWidth()?8:4,c=this._getHostWidth()/a-2*b,d=Polymer.dom(this.root).querySelectorAll('lazy-image');d.forEach(f=>{f.style.width=`${c}px`,f.style.height=`${c}px`})})}_shouldShowFollowButton(a){if(!a)return!0}}window.customElements.define(InstagramFeed.is,InstagramFeed);</script></dom-module></body></html>